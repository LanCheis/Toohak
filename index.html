<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Đăng nhập - Đồ án Trắc nghiệm</title>
    <link rel="stylesheet" href="./style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
</head>
<body>

    <div class="wrapper">
        <div class="container">
            <h1>Đăng Nhập</h1>
            <p>Chọn phương thức đăng nhập để bắt đầu.</p>
            
            <form id="guest-form" class="form-group" style="margin-top: 1rem;">
                <label for="username">Khách (Guest):</label>
                <input type="text" id="username" placeholder="Nhập tên của bạn..." required>
                <button type="submit" class="btn btn-guest" style="margin-top: 1rem;">
                    Bắt đầu với tên này
                </button>
            </form>

            <div class="divider">--- Hoặc đăng nhập bằng ---</div>

            <div class="social-login">
                <button id="btn-google" class="btn btn-google">
                    <i class="fa-brands fa-google"></i> Tiếp tục với Google
                </button>
                
                <button id="btn-facebook" class="btn btn-facebook">
                    <i class="fa-brands fa-facebook-f"></i> Tiếp tục với Facebook
                </button>
            </div>
        </div>
    </div>

    <script>
        // --- 1. LOGIC LUÔN RESET VỀ TRANG LOGIN ---
        // Ngay khi trang này tải, xoá thông tin người dùng cũ đi.
        // Điều này đảm bảo mỗi lần vào đây là một lần đăng nhập mới.
        localStorage.removeItem('currentUser');
        console.log("Đã reset phiên đăng nhập cũ.");

        // --- 2. XỬ LÝ ĐĂNG NHẬP GUEST ---
        document.getElementById('guest-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('username').value.trim();
            if (username) {
                loginUser(username);
            }
        });

        // --- 3. XỬ LÝ GIẢ LẬP GOOGLE ---
        document.getElementById('btn-google').addEventListener('click', function() {
            const btn = this;
            const originalText = btn.innerHTML;
            
            // Hiệu ứng "Đang tải..."
            btn.innerHTML = '<i class="fa-solid fa-circle-notch fa-spin"></i> Đang kết nối...';
            btn.style.opacity = "0.7";

            // Giả lập độ trễ mạng 1.5 giây
            setTimeout(() => {
                // Tự động lấy tên từ Google (Giả lập)
                loginUser("Google User"); 
            }, 1500);
        });

        // --- 4. XỬ LÝ GIẢ LẬP FACEBOOK ---
        document.getElementById('btn-facebook').addEventListener('click', function() {
            const btn = this;
            
            // Hiệu ứng "Đang tải..."
            btn.innerHTML = '<i class="fa-solid fa-circle-notch fa-spin"></i> Đang kết nối...';
            btn.style.opacity = "0.7";

            setTimeout(() => {
                // Tự động lấy tên từ Facebook (Giả lập)
                loginUser("Facebook User"); 
            }, 1500);
        });

        // --- HÀM CHUNG: LƯU VÀ CHUYỂN TRANG ---
        function loginUser(name) {
            localStorage.setItem('currentUser', name);
            // Chuyển sang menu
            window.location.href = 'menu.html';
        }
    </script>

</body>
</html>